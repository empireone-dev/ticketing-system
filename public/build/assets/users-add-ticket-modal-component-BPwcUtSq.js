import{r as p,u as d,j as a,s as o}from"./app-D8UVsU9_.js";import{T as k,R as v}from"./textarea-BDK4mBjk.js";import{c as L}from"./tickets-thunk-BkjcOWjo.js";import{I as u}from"./input-CrWU3Q2p.js";import{a as C}from"./it-thunk-DfvPoSBN.js";import{a as S}from"./category-thunk-BvRsquQv.js";import{S as w}from"./select-K0KrW89c.js";import{s as U}from"./app-thunk-CkMwKUSV.js";import{h as n}from"./moment-C5S46NFB.js";import{s as N}from"./index-DoeuryOz.js";import{M as T}from"./index-Ic6BITyj.js";import{U as D}from"./index-8NOglsxL.js";import{B as O}from"./button-KATubA8M.js";import{D as R}from"./index-B7K5xBBx.js";import"./AntdIcon-xK6opElJ.js";import"./index-CP1-oak8.js";import"./ticket-service-D4WVovVz.js";import"./index-iEcnCCBl.js";import"./ContextIsolator-HQOya1na.js";import"./motion-ByB30ZlM.js";import"./PurePanel-CQrGzdPY.js";import"./useForceUpdate-CTSd-Z0x.js";import"./EyeOutlined-B0hE2UvW.js";import"./CheckOutlined-Cectf60u.js";import"./roundedArrow-qnbl9B_7.js";import"./index-jRNQHSpj.js";function oe({isOpen:g,closeModal:l}){const[f,m]=p.useState(!1),[e,i]=p.useState({status:"Pending"});d(t=>t.it);const{user:c}=d(t=>t.app),[h,x]=N.useMessage(),{RangePicker:y}=R,{allCategories:j}=d(t=>t.category);function _(t){return!(t==null?void 0:t.some(r=>r.status!=="done"))}async function b(t){t.preventDefault(),m(!0);const s=new FormData;if(s.append("assigned_to",e.assigned_to),s.append("category_id",e.category_id),s.append("details",e.details),s.append("station",e.station),s.append("status",e.status),s.append("isUrgent",e.isUrgent),s.append("user_id",c.id),s.append("others",e.others),s.append("start",(e==null?void 0:e.start)??n().format("LLLL")),s.append("end",(e==null?void 0:e.end)??n().format("LLLL")),_(e.files)&&e.files)for(let r=0;r<e.files.length;r++)e.files[r].name!=="uploaded"&&e.files[r].status=="done"&&s.append("files[]",e.files[r].originFileObj);await o.dispatch(L(s)),await o.dispatch(C(c.id)),await o.dispatch(U(s)),e.category_id=="Others"&&await o.dispatch(S()),await h.success("Created Successfully!"),i({status:"Pending"}),l(),m(!1)}return a.jsxs(a.Fragment,{children:[x,a.jsx(T,{title:"Ticket Information",okText:"Submit",onOk:b,confirmLoading:f,open:g,onCancel:l,children:a.jsxs("form",{className:"max-w-full mx-auto mt-4 ",children:[a.jsxs("div",{className:"grid md:gap-6",children:[a.jsx(w,{value:e.category_id,label:"Category",name:"category_id",onChange:t=>i({...e,category_id:t.target.value}),options:j.map(t=>({label:t.name,value:t.id}))}),e.category_id=="Others"&&a.jsx(u,{onChange:t=>i({...e,others:t.target.value}),value:e.others??"",required:"true",name:"others",label:"Other Request",type:"text"})]}),a.jsx("div",{className:"grid md:gap-6 mt-4 ",children:a.jsx(y,{onChange:t=>i({...e,start:n(t[0].$d).format("LLLL"),end:n(t[1].$d).format("LLLL")}),showTime:!0})}),a.jsx("div",{className:"grid md:gap-6 mt-4 ",children:a.jsx(k,{onChange:t=>i({...e,details:t.target.value}),value:e.details??"",required:"true",name:"details",label:"Request Details",type:"text"})}),a.jsx("div",{className:"grid md:gap-6 mt-4 mb-7 ",children:a.jsx(u,{onChange:t=>i({...e,station:t.target.value}),value:e.station??"",name:"station",label:"PC/Station No.",type:"text"})}),a.jsx(D,{onChange:t=>i({...e,files:t.fileList}),multiple:!0,action:"https://660d2bd96ddfa2943b33731c.mockapi.io/api/upload",listType:"picture",method:"GET",className:"upload-list-inline",children:a.jsx(O,{icon:a.jsx(v,{}),children:"Upload"})}),a.jsxs("div",{class:"flex items-center my-4",children:[a.jsx("input",{id:"default-checkbox",type:"checkbox",value:"",name:"isUrgent",checked:e.isUrgent=="true",onChange:t=>i({...e,[t.target.name]:JSON.stringify(t.target.checked)}),class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500   focus:ring-2 "}),a.jsx("label",{for:"default-checkbox",class:"ms-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Is Urgent"})]})]})})]})}export{oe as default};
