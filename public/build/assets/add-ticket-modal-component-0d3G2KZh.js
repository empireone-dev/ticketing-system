import{r as f,u as d,b as C,j as a,s as r}from"./app-KGURJvNS.js";import{c as S,g as w}from"./tickets-thunk-C0DiHT0t.js";import{T as N,R as T}from"./textarea-B1W0D_KO.js";import{S as m,I as h}from"./select-DEw35HcV.js";import{g as U}from"./it-thunk-CzsDABPj.js";import{s as D}from"./app-thunk-Cz6OYBq-.js";import{h as l}from"./moment-C5S46NFB.js";import{s as O}from"./index-CUZrsJtt.js";import{M as P}from"./index-CphuGZRY.js";import{U as A}from"./index-BlTlceqr.js";import{B as I}from"./button-DFXSIZ5g.js";import{D as R}from"./index-BNwYF4eM.js";import"./ticket-service-D4cDv8aV.js";import"./AntdIcon-B3AhaI-z.js";import"./index-aI-tGgtP.js";import"./index-CoZ8B0f4.js";import"./ContextIsolator-BZ9yY1fb.js";import"./motion-BTC66nEt.js";import"./PurePanel-CXm1I7u3.js";import"./useForceUpdate-qfPOaPef.js";import"./EyeOutlined-YMH6Zx9w.js";import"./CheckOutlined-BAaiVgXj.js";import"./roundedArrow-CPjH2Rl3.js";import"./index-D32UE55k.js";function re({isOpen:x,closeModal:c}){var g;const[v,u]=f.useState(!1),{RangePicker:b}=R,[t,i]=f.useState({status:"Pending"}),{users:n}=d(e=>e.it),{user:p}=d(e=>e.app);C();const[j,y]=O.useMessage(),{allCategories:_}=d(e=>e.category);function k(e){return!(e==null?void 0:e.some(o=>o.status!=="done"))}async function L(e){e.preventDefault(),u(!0);const s=new FormData;if(s.append("assigned_to",t.assigned_to),s.append("category_id",t.category_id),s.append("details",t.details),s.append("station",t.station),s.append("status",t.status),s.append("isUrgent",t.isUrgent),s.append("user_id",p.id),s.append("start",(t==null?void 0:t.start)??l().format("LLLL")),s.append("end",(t==null?void 0:t.end)??l().format("LLLL")),k(t.files)&&t.files)for(let o=0;o<t.files.length;o++)t.files[o].name!=="uploaded"&&t.files[o].status=="done"&&s.append("files[]",t.files[o].originFileObj);await r.dispatch(S(s)),await r.dispatch(U(2)),await r.dispatch(w(p)),await r.dispatch(D(s)),await j.success("Created Successfully!"),i({}),c(),u(!1)}return console.log("usersss",n),a.jsxs(a.Fragment,{children:[y,a.jsx(P,{title:"Ticket Information",okText:"Submit",onOk:L,confirmLoading:v,open:x,onCancel:c,children:a.jsxs("form",{className:"max-w-full mx-auto mt-4 ",children:[a.jsxs("div",{className:"grid md:gap-6",children:[a.jsx(m,{value:t.category_id,label:"Category",name:"category_id",required:"true",onChange:e=>i({...t,category_id:e.target.value}),options:_.map(e=>({label:e.name,value:e.id}))}),t.category_id=="Others"&&a.jsx(h,{onChange:e=>i({...t,others:e.target.value}),value:t.others??"",required:"true",name:"others",label:"Other Request",type:"text"})]}),a.jsx("div",{className:"grid md:gap-6 mt-4 ",children:a.jsx(b,{onChange:e=>i({...t,start:l(e[0].$d).format("LLLL"),end:l(e[1].$d).format("LLLL")}),showTime:!0})}),a.jsx("div",{className:"grid md:gap-6 mt-4 ",children:a.jsx(N,{onChange:e=>i({...t,details:e.target.value}),value:t.details??"",required:"true",name:"details",label:"Request Details",type:"text"})}),a.jsx("div",{className:"grid md:gap-6 mt-4 mb-7 ",children:a.jsx(h,{onChange:e=>i({...t,station:e.target.value}),value:t.station??"",name:"station",label:"PC/Station No.",type:"text"})}),a.jsx("div",{className:"relative z-0 w-full mb-6 group mt-4 ",children:a.jsx(m,{value:t.assigned_to,label:"Select IT Personnel",name:"assigned_to",onChange:e=>i({...t,assigned_to:e.target.value}),options:(g=n==null?void 0:n.data)==null?void 0:g.map(e=>({label:e.name,value:e.id}))})}),a.jsx("div",{className:"relative z-0 w-full mb-6 group",children:a.jsx(m,{value:t.status,label:"Status",name:"status",onChange:e=>i({...t,status:e.target.value}),options:[{name:"Pending",value:"Pending"},{name:"Assigned",value:"Assigned"},{name:"Ongoing",value:"Ongoing"},{name:"Closed",value:"Closed"}].map(e=>({label:e.name,value:e.id}))})}),a.jsx(A,{onChange:e=>i({...t,files:e.fileList}),multiple:!0,action:"https://660d2bd96ddfa2943b33731c.mockapi.io/api/upload",listType:"picture",method:"GET",className:"upload-list-inline",children:a.jsx(I,{icon:a.jsx(T,{}),children:"Upload"})}),a.jsxs("div",{class:"flex items-center my-4",children:[a.jsx("input",{id:"default-checkbox",type:"checkbox",checked:t.isUrgent=="true",name:"isUrgent",onChange:e=>i({...t,[e.target.name]:JSON.stringify(e.target.checked)}),class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500   focus:ring-2 "}),a.jsx("label",{for:"default-checkbox",class:"ms-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Is Urgent"})]})]})})]})}export{re as default};
