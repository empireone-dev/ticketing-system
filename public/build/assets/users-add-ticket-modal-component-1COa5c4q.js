import{r as p,u as c,j as s,s as r}from"./app-AgT5TB4z.js";import{W as L,R as C}from"./wysiwyg-BnuWDtdL.js";import{c as S}from"./tickets-thunk-DvSAVAlt.js";import{I as u}from"./input-Cq5rjFqZ.js";import{a as w}from"./it-thunk-rUarACdr.js";import{a as N}from"./category-thunk-VgwGH7v_.js";import{S as g}from"./select-C_iWfbwv.js";import{s as U}from"./app-thunk-SgXynJQl.js";import{h as n}from"./moment-C5S46NFB.js";import{s as O}from"./index-oP_ITGZA.js";import{D as T}from"./index-Dw7q5MZ4.js";import{M as D}from"./index-CcfyqdZx.js";import{U as I}from"./index-BSdPsLIT.js";import{B as P}from"./button-9KIdYm7W.js";import"./AntdIcon-Bl93TFf8.js";import"./index-B5LlO03B.js";import"./ticket-service-UpIfqeMo.js";import"./index-7qThCQ-s.js";import"./ContextIsolator-BbJO7qHI.js";import"./motion-L-UsFLS3.js";import"./PurePanel-DeklmeR1.js";import"./CheckOutlined-DnJEy8xG.js";import"./index-BqT55qqi.js";import"./roundedArrow-Bx5oMN0O.js";import"./useForceUpdate-DlVxoJeG.js";import"./EyeOutlined-B6FmIrDd.js";function ce({isOpen:f,closeModal:l}){const[h,d]=p.useState(!1),[e,i]=p.useState({status:"Pending"}),{users:R}=c(t=>t.it),{user:m}=c(t=>t.app),[x,y]=O.useMessage(),{RangePicker:j}=T,{allCategories:b}=c(t=>t.category);function v(t){return!(t==null?void 0:t.some(o=>o.status!=="done"))}async function _(t){t.preventDefault(),d(!0);const a=new FormData;if(a.append("assigned_to",e.assigned_to),a.append("category_id",e.category_id),a.append("details",e.details),a.append("station",e.station),a.append("scsite",e.scsite),a.append("status",e.status),a.append("isUrgent",e.isUrgent),a.append("user_id",m.id),a.append("others",e.others),a.append("start",(e==null?void 0:e.start)??n().format("LLLL")),a.append("end",(e==null?void 0:e.end)??n().format("LLLL")),v(e.files)&&e.files)for(let o=0;o<e.files.length;o++)e.files[o].name!=="uploaded"&&e.files[o].status=="done"&&a.append("files[]",e.files[o].originFileObj);await r.dispatch(S(a)),await r.dispatch(w(m.id)),await r.dispatch(U(a)),e.category_id=="Others"&&await r.dispatch(N()),await x.success("Created Successfully!"),i({status:"Pending"}),l(),d(!1)}const k=["2nd Site","3rd Site"];return s.jsxs(s.Fragment,{children:[y,s.jsx(D,{title:"Ticket Information",okText:"Submit",onOk:_,confirmLoading:h,open:f,onCancel:l,width:800,children:s.jsxs("form",{className:"max-w-full mx-auto mt-4 ",children:[s.jsxs("div",{className:"grid md:gap-6",children:[s.jsx(g,{value:e.category_id,label:"Category",name:"category_id",onChange:t=>i({...e,category_id:t.target.value}),options:b.slice().sort((t,a)=>t.name.localeCompare(a.name)).map(t=>({label:t.name,value:t.id}))}),e.category_id=="Others"&&s.jsx(u,{onChange:t=>i({...e,others:t.target.value}),value:e.others??"",required:"true",name:"others",label:"Other Request",type:"text"})]}),s.jsx("div",{className:"grid md:gap-6 mt-4 ",children:s.jsx(j,{onChange:t=>i({...e,start:n(t[0].$d).format("LLLL"),end:n(t[1].$d).format("LLLL")}),showTime:!0})}),s.jsx("div",{className:"grid md:gap-6 mt-4 ",children:s.jsx(L,{onChange:t=>i({...e,details:t}),value:(e==null?void 0:e.details)??""})}),s.jsx("div",{className:"grid md:gap-6 mt-4 mb-7 ",children:s.jsx(u,{onChange:t=>i({...e,station:t.target.value}),value:e.station??"",name:"station",label:"PC/Station No.",type:"text"})}),s.jsx("div",{className:"grid md:gap-6 mb-4",children:s.jsx(g,{value:e.scsite,label:"Site",name:"scsite",onChange:t=>i({...e,scsite:t.target.value}),options:k.map(t=>({label:t,value:t}))})}),s.jsx(I,{onChange:t=>i({...e,files:t.fileList}),multiple:!0,action:"https://660d2bd96ddfa2943b33731c.mockapi.io/api/upload",listType:"picture",method:"GET",className:"upload-list-inline",children:s.jsx(P,{icon:s.jsx(C,{}),children:"Upload"})}),s.jsxs("div",{class:"flex items-center my-4",children:[s.jsx("input",{id:"default-checkbox",type:"checkbox",value:"",name:"isUrgent",checked:e.isUrgent=="true",onChange:t=>i({...e,[t.target.name]:JSON.stringify(t.target.checked)}),class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500   focus:ring-2 "}),s.jsx("label",{for:"default-checkbox",class:"ms-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Is Urgent"})]})]})})]})}export{ce as default};
