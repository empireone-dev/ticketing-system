import{r as u,u as l,j as a,s as r}from"./app-C0WyRLcI.js";import{W as S,R as k}from"./wysiwyg-Bi7QLltC.js";import{c as w}from"./tickets-thunk-R62dopSU.js";import{I as g}from"./input-BM3N_a7j.js";import{a as P}from"./it-thunk-De8DqwXV.js";import{a as U}from"./category-thunk-CNUdR0rz.js";import{S as m}from"./select-CucsIfjO.js";import{s as N}from"./app-thunk-B48XohI9.js";import{h as n}from"./moment-C5S46NFB.js";import{s as T}from"./index-C23eD86r.js";import{D}from"./index-C-H4eJkD.js";import{M}from"./index-BY8JHdiz.js";import{U as R}from"./index-5B3e9luH.js";import{B as O}from"./button-6bR5bYnq.js";import"./AntdIcon-DJnEyK1F.js";import"./index-Dfn0g3Cp.js";import"./ticket-service-5F6Gh1k-.js";import"./index-D_uWLhbh.js";import"./ContextIsolator-Bs1dQBqP.js";import"./motion-FbX1Oq8L.js";import"./PurePanel-B0xQ7Yik.js";import"./CheckOutlined-c6Y6oQAf.js";import"./index-BmeB1WMf.js";import"./roundedArrow-B7mTp6-9.js";import"./useForceUpdate-DYQURU0l.js";import"./EyeOutlined-DPSse4my.js";function me({isOpen:f,closeModal:p}){const[h,c]=u.useState(!1),[e,i]=u.useState({status:"Pending"}),{users:A}=l(t=>t.it),{user:d}=l(t=>t.app),[x,v]=T.useMessage(),{RangePicker:y}=D,{allCategories:j}=l(t=>t.category);function b(t){return!(t==null?void 0:t.some(o=>o.status!=="done"))}const L=e.scsite==="Carcar Site"?79:0;async function _(t){t.preventDefault(),c(!0);const s=new FormData;if(s.append("assigned_to",L??""),s.append("category_id",e.category_id),s.append("details",e.details),s.append("station",e.station),s.append("scsite",e.scsite),s.append("status",e.status),s.append("isUrgent",e.isUrgent),s.append("user_id",d.id),s.append("others",e.others),s.append("start",(e==null?void 0:e.start)??n().format("LLLL")),s.append("end",(e==null?void 0:e.end)??n().format("LLLL")),b(e.files)&&e.files)for(let o=0;o<e.files.length;o++)e.files[o].name!=="uploaded"&&e.files[o].status=="done"&&s.append("files[]",e.files[o].originFileObj);await r.dispatch(w(s)),await r.dispatch(P(d.id)),await r.dispatch(N(s)),e.category_id=="Others"&&await r.dispatch(U()),await x.success("Created Successfully!"),i({status:"Pending"}),p(),c(!1)}const C=["San Carlos 2nd Site","San Carlos 3rd Site","Carcar Site"];return a.jsxs(a.Fragment,{children:[v,a.jsx(M,{title:"Ticket Information",okText:"Submit",onOk:_,confirmLoading:h,open:f,onCancel:p,width:800,children:a.jsxs("form",{className:"max-w-full mx-auto mt-4 ",children:[a.jsxs("div",{className:"grid md:gap-6",children:[a.jsx(m,{value:e.category_id,label:"Category",name:"category_id",onChange:t=>i({...e,category_id:t.target.value}),options:j.slice().sort((t,s)=>t.name.localeCompare(s.name)).map(t=>({label:t.name,value:t.id}))}),e.category_id=="Others"&&a.jsx(g,{onChange:t=>i({...e,others:t.target.value}),value:e.others??"",required:"true",name:"others",label:"Other Request",type:"text"})]}),a.jsx("div",{className:"grid md:gap-6 mt-4 ",children:a.jsx(y,{onChange:t=>i({...e,start:n(t[0].$d).format("LLLL"),end:n(t[1].$d).format("LLLL")}),showTime:!0})}),a.jsx("div",{className:"grid md:gap-6 mt-4 ",children:a.jsx(S,{onChange:t=>i({...e,details:t}),value:(e==null?void 0:e.details)??"",label:"Request Details"})}),a.jsx("div",{className:"grid md:gap-6 mt-4 mb-7 ",children:a.jsx(g,{onChange:t=>i({...e,station:t.target.value}),value:e.station??"",name:"station",label:"PC/Station No.",type:"text"})}),a.jsx("div",{className:"grid md:gap-6 mb-4",children:a.jsx(m,{value:e.scsite,label:"Site",name:"scsite",onChange:t=>i({...e,scsite:t.target.value}),options:C.map(t=>({label:t,value:t}))})}),a.jsx(R,{onChange:t=>i({...e,files:t.fileList}),multiple:!0,action:"https://660d2bd96ddfa2943b33731c.mockapi.io/api/upload",listType:"picture",method:"GET",className:"upload-list-inline",children:a.jsx(O,{icon:a.jsx(k,{}),children:"Upload"})}),a.jsx("div",{class:"flex items-center my-4",children:a.jsx(m,{value:e==null?void 0:e.isUrgent,label:"Urgent Type",name:"isUrgent",onChange:t=>i({...e,isUrgent:t.target.value}),options:[{label:"Low Priority",value:"Low Priority"},{label:"Medium Priority",value:"Medium Priority"},{label:"High Priority",value:"High Priority"}].map(t=>({label:t.label,value:t.value}))})})]})})]})}export{me as default};
