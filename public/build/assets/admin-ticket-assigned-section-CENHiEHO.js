import{r as o,u as m,s as d,j as a}from"./app-COo0Ml3_.js";import{u as y,a as k}from"./tickets-thunk-BHh1PGZp.js";import{g as S}from"./it-thunk-Dz0sPSh5.js";import{s as j}from"./index-CkJvu33b.js";import{B as w}from"./button-e6x1uJ4B.js";import{M as v}from"./index-zjB3nYwf.js";import{S as M}from"./index-Bqsv-zi4.js";import{I as b}from"./index-lELXij-V.js";import"./ticket-service-D1UoAY0l.js";import"./index-DYr99NC_.js";import"./AntdIcon-Bg-C4_Ml.js";import"./index-Cp1GGgKJ.js";import"./ContextIsolator-C4_JbWxR.js";import"./motion-BnuLouRg.js";import"./PurePanel-CYWCaPPW.js";import"./CheckOutlined-Bc0CKz9P.js";import"./index-DkgbD6ck.js";import"./EyeOutlined-DcsAxgYe.js";const{TextArea:T}=b;function Q(){var p;const[f,r]=o.useState(!1),[n,g]=j.useMessage(),{users:e}=m(t=>t.it),{user:l}=m(t=>t.app),[h,i]=o.useState(!1),[s,c]=o.useState({status:"Assigned",user_id:l==null?void 0:l.id,ticket_id:window.location.pathname.split("/")[3],assigned_to:((p=e==null?void 0:e[0])==null?void 0:p.id)||null,notes:""});o.useEffect(()=>{Array.isArray(e)&&e.length>0&&c(t=>{var u;return{...t,assigned_to:(u=e[0])==null?void 0:u.id}})},[e]),o.useEffect(()=>{d.dispatch(S(2))},[]);const _=()=>{r(!0)};async function x(){if(i(!0),s.notes)try{await d.dispatch(y(s)),await d.dispatch(k()),n.success("Updated successfully!"),setTimeout(()=>{i(!1),r(!1)},2e3)}catch{n.error("Failed to update ticket!"),i(!1)}else n.error("Notes is required!"),i(!1)}const A=()=>{r(!1)};return a.jsxs("div",{children:[g,a.jsx(w,{size:"large",type:"primary",danger:!0,onClick:_,children:"Assign Ticket"}),a.jsx(v,{title:"Assign Ticket",open:f,onOk:x,okText:"Submit",confirmLoading:h,onCancel:A,children:a.jsxs("div",{className:"flex flex-col gap-4",children:[s.status==="Assigned"&&a.jsx(M,{size:"large",value:s.assigned_to,className:"w-full",onChange:t=>c({...s,assigned_to:t}),options:Array.isArray(e)&&e.length>0?e.map(t=>({value:t.id,label:t.name})):[],placeholder:Array.isArray(e)&&e.length>0?"Select user":"No users available",disabled:!Array.isArray(e)||e.length===0}),a.jsx(T,{value:s.notes,onChange:t=>c({...s,notes:t.target.value}),placeholder:"Notes",autoSize:{minRows:3,maxRows:5}})]})})]})}export{Q as default};
